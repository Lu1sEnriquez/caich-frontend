<!-- Hover Trigger Zone - Se muestra cuando el sidebar estÃ¡ colapsado -->
@if (isCollapsed()) {
<div class="sidebar-hover-trigger" (mouseenter)="expandSidebar()"></div>
}

<aside class="sidebar" [class.collapsed]="isCollapsed()" (mouseenter)="onSidebarMouseEnter()" (mouseleave)="onSidebarMouseLeave()">
  <!-- Toggle Button - COMENTADO POR AHORA -->
  <!--
  <button class="sidebar-toggle" (click)="toggleSidebar()" [title]="isCollapsed() ? 'Expandir sidebar' : 'Contraer sidebar'">
    <span class="toggle-icon">{{ isCollapsed() ? 'â–¶' : 'â—€' }}</span>
  </button>
  -->

  <!-- Logo -->
  <div class="sidebar-header">
    <button class="logo" (click)="goToDashboard()" title="Ir a Dashboard">
      <div class="logo-content">
        <span class="logo-icon">ðŸ§ </span>
        <span class="logo-text">{{ appName() }}</span>
      </div>
      <!-- Badge con contador de items importantes -->
      @if (totalNotifications() > 0) {
      <button
        (click)="toggleNotifications(); $event.stopPropagation()"
        class="logo-notif-badge-btn"
        [title]="notificationTooltip()"
      >
        <app-badge variant="danger" class="logo-notif-badge">
          {{ totalNotifications() }}
        </app-badge>
      </button>
      } @else {
      <button
        (click)="toggleNotifications(); $event.stopPropagation()"
        class="logo-notif-badge-btn"
        title="Notificaciones"
      >
        <span class="notif-icon">ðŸ””</span>
      </button>
      }
    </button>
  </div>

  <!-- Notification Panel - Visible cuando estÃ¡ abierto -->
  @if (notificationsPanelIsOpen()) {
  <div class="notifications-panel-wrapper">
    <app-notification-panel (closed)="toggleNotifications()"></app-notification-panel>
  </div>
  }

  <!-- Navigation -->
  <nav class="sidebar-nav">
    @for (group of menuGroups(); track group.title) {
    <div class="menu-group">
      @if (group.title) {
      <div class="menu-group-title">{{ group.title }}</div>
      }

      <ul class="menu-items">
        @for (item of group.items; track item.label) {
        <li class="menu-item">
          <a
            [routerLink]="item.route"
            routerLinkActive="active"
            [routerLinkActiveOptions]="{ exact: false }"
            class="menu-link"
            [title]="item.label"
            (click)="collapseSidebar()"
          >
            @if (item.icon) {
            <span class="menu-icon">{{ item.icon }}</span>
            }
            <span class="menu-label">{{ item.label }}</span>
            @if (item.badge) {
            <app-badge variant="info" class="menu-badge">
              {{ item.badge }}
            </app-badge>
            }
          </a>
        </li>
        }
      </ul>
    </div>
    }
  </nav>

  <!-- User Section -->
  <div class="sidebar-footer">
    <div class="user-section">
      <div class="user-profile">
        <img
          *ngIf="currentUser()?.foto"
          [src]="currentUser()?.foto"
          alt="Avatar"
          class="user-avatar"
        />
        <div
          *ngIf="!currentUser()?.foto"
          class="user-avatar user-avatar-placeholder"
        >
          {{ (currentUserName() || 'U').charAt(0).toUpperCase() }}
        </div>
        <div class="user-details">
          <div class="user-name">{{ currentUserName() }}</div>
          <div class="user-role-display">{{ userRole() }}</div>
        </div>
      </div>

      <button class="logout-button" (click)="onLogoutClick()">
        <span>{{ logoutLabel() }}</span>
      </button>
    </div>
  </div>
</aside>
