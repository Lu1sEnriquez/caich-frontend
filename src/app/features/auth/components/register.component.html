<div class="auth-container">
  <div class="auth-card">
    <div class="auth-header">
      <div class="logo">
        <span class="logo-icon">üß†</span>
        <h1>MindCare</h1>
      </div>
      <h2>Crear Cuenta</h2>
      <p>Reg√≠strate para comenzar</p>
    </div>

    <!-- Mensaje de √©xito -->
    @if (registroExitoso()) {
    <div class="success-message">
      <span>‚úÖ</span>
      <div>
        <strong>¬°Registro exitoso!</strong>
        <p>Tu cuenta ha sido creada. Ahora puedes iniciar sesi√≥n.</p>
        <app-button variant="primary" [fullWidth]="true" (clicked)="irALogin()">
          Ir a Iniciar Sesi√≥n
        </app-button>
      </div>
    </div>
    } @else {
    <form class="auth-form" (ngSubmit)="handleRegister()">
      <!-- Nombre Completo -->
      <app-input
        label="Nombre completo"
        type="text"
        placeholder="Juan P√©rez Garc√≠a"
        [(value)]="nombreCompleto"
        [required]="true"
      />

      <!-- Email -->
      <app-input
        label="Correo electr√≥nico"
        type="email"
        placeholder="tu@email.com"
        [(value)]="email"
        [required]="true"
      />

      <!-- Folio -->
      <app-input label="Folio (opcional)" type="text" placeholder="12345678" [(value)]="folio" />

      <!-- Tel√©fono -->
      <app-input
        label="Tel√©fono (opcional)"
        type="tel"
        placeholder="6441234567"
        [(value)]="telefono"
        [hint]="'10 d√≠gitos sin espacios'"
      />

      <!-- Rol -->
      <div class="form-field">
        <label>Tipo de cuenta</label>
        <select [(ngModel)]="rol" name="rol" class="select-input">
          @for (role of rolesDisponibles; track role.value) {
          <option [value]="role.value">{{ role.label }}</option>
          }
        </select>
      </div>

      <!-- ID del estudiante (solo para Alumno) -->
      @if (rol() === 'Alumno') {
      <app-input
        label="ID del estudiante"
        type="text"
        placeholder="00000248171"
        [(value)]="idAlumno"
        [required]="true"
        [hint]="'Requerido para rol Alumno'"
      />
      }

      <!-- Contrase√±a -->
      <app-input
        label="Contrase√±a"
        type="password"
        placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢"
        [(value)]="password"
        [required]="true"
        [hint]="'M√≠nimo 6 caracteres'"
      />

      <!-- Confirmar Contrase√±a -->
      <app-input
        label="Confirmar contrase√±a"
        type="password"
        placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢"
        [(value)]="confirmPassword"
        [required]="true"
      />

      <!-- Error general -->
      @if (registerResource.error()) {
      <div class="error-message">
        <span>‚ùå</span>
        <span>{{ registerResource.error()?.message || 'Error al crear cuenta' }}</span>
      </div>
      }

      <!-- Loading state -->
      @if (registerResource.isLoading()) {
      <div class="loading-message">
        <span class="spinner">‚è≥</span>
        <span>Creando tu cuenta...</span>
        <span class="loading-subtitle">Esto puede tomar unos segundos</span>
      </div>
      }

      <!-- Bot√≥n de registro -->
      <app-button
        type="submit"
        variant="primary"
        [fullWidth]="true"
        [disabled]="registerResource.isLoading()"
      >
        @if (registerResource.isLoading()) {
        <span>Registrando...</span>
        } @else {
        <span>Crear Cuenta</span>
        }
      </app-button>

      <!-- Link a login -->
      <div class="auth-footer">
        <p>
          ¬øYa tienes cuenta?
          <a routerLink="/login">Inicia sesi√≥n aqu√≠</a>
        </p>
      </div>
    </form>
    }
  </div>
</div>
